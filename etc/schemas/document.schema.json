{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://kemet-data.org/schemas/document.v1.json",
  "title": "Document",
  "description": "Schema for a document (work or logical unit) in the KEMET corpus",
  "type": "object",
  "required": [
    "document_id",
    "source",
    "collection",
    "stage",
    "substage",
    "language",
    "provenance"
  ],
  "properties": {
    "document_id": {
      "type": "string",
      "description": "Stable, namespaced document identifier",
      "pattern": "^[a-z_]+:[a-z_]+:.+$"
    },
    "source": {
      "type": "string",
      "description": "Source system name",
      "enum": ["scriptorium", "tla", "horner", "ud_coptic", "lexica", "test"]
    },
    "collection": {
      "type": "string",
      "description": "Collection or corpus name within the source"
    },
    "stage": {
      "type": "string",
      "description": "Language stage",
      "enum": ["COPTIC", "EGYPTIAN"]
    },
    "substage": {
      "type": "string",
      "description": "Language substage or dialect",
      "enum": [
        "SAHIDIC",
        "BOHAIRIC",
        "FAYYUMIC",
        "AKHMIMIC",
        "LYCOPOLITAN",
        "OLD_EGYPTIAN",
        "MIDDLE_EGYPTIAN",
        "LATE_EGYPTIAN",
        "DEMOTIC",
        "UNKNOWN"
      ]
    },
    "language": {
      "type": "string",
      "description": "ISO 639-3 language code",
      "pattern": "^[a-z]{3}$"
    },
    "title": {
      "type": ["string", "null"],
      "description": "Document title"
    },
    "authors": {
      "type": "array",
      "description": "List of authors",
      "items": {
        "type": "string"
      },
      "default": []
    },
    "date_from": {
      "type": ["integer", "null"],
      "description": "Start date (negative for BCE, positive for CE)"
    },
    "date_to": {
      "type": ["integer", "null"],
      "description": "End date (negative for BCE, positive for CE)"
    },
    "genre": {
      "type": "array",
      "description": "List of genre tags",
      "items": {
        "type": "string"
      },
      "default": []
    },
    "license": {
      "type": "string",
      "description": "License information",
      "default": "SEE_SOURCE"
    },
    "provenance": {
      "type": "object",
      "description": "Provenance metadata",
      "required": ["source_item_id", "retrieved_at", "hash_raw", "parser_version"],
      "properties": {
        "source_item_id": {
          "type": "string",
          "description": "Native ID or URL from source"
        },
        "retrieved_at": {
          "type": "string",
          "description": "ISO 8601 timestamp of retrieval",
          "format": "date-time"
        },
        "hash_raw": {
          "type": "string",
          "description": "BLAKE3 hash of raw payload",
          "pattern": "^blake3:[a-f0-9]{64}$"
        },
        "parser_version": {
          "type": "string",
          "description": "Parser identifier and version"
        }
      }
    },
    "counts": {
      "type": "object",
      "description": "Document statistics",
      "properties": {
        "segments": {
          "type": "integer",
          "minimum": 0
        },
        "tokens": {
          "type": "integer",
          "minimum": 0
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional source-specific metadata"
    }
  }
}
